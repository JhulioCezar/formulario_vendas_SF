<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4CAF50">
    <meta name="description" content="Formul√°rio de Abertura de Chamado - Pessoa Jur√≠dica com Internet e Telefone Fixo">
    <title>Abertura de Chamados - PJ Internet + Telefone Fixo</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="android-icon-192x192.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #007bff 0%, #00c6ff 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .logo img {
            max-width: 220px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-weight: 600;
            position: relative;
            padding-bottom: 15px;
            font-size: 28px;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, #4CAF50, #2196F3);
            border-radius: 3px;
        }
        
        .payment-options {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            gap: 15px;
        }
        
        .payment-option {
            padding: 12px 25px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            background-color: #f9f9f9;
            transition: all 0.3s;
            font-weight: 500;
            flex: 1;
            text-align: center;
            max-width: 200px;
        }
        
        .payment-option.active {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-color: #4CAF50;
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
        }
        
        .form-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-section.active {
            display: block;
        }
        
        .section-title {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            padding: 12px 15px;
            margin: 25px 0 18px;
            border-left: 5px solid #4CAF50;
            font-weight: 600;
            border-radius: 0 8px 8px 0;
            color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 18px;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #444;
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: #fafafa;
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
            background-color: white;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
        }
        
        .checkbox-group input {
            width: auto;
            margin-right: 10px;
        }
        
        .gps-button, .autofill-button {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 5px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .autofill-button {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
            margin-bottom: 10px;
        }
        
        .gps-button:hover, .autofill-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);
        }
        
        .gps-button:active, .autofill-button:active {
            transform: translateY(0);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .copy-btn, .save-btn, .clear-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .copy-btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
        }
        
        .copy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(33, 150, 243, 0.3);
        }
        
        .save-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(76, 175, 80, 0.3);
        }
        
        .clear-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }
        
        .clear-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(255, 152, 0, 0.3);
        }
        
        .required::after {
            content: " *";
            color: #f44336;
        }
        
        .hidden {
            display: none;
        }
        
        .loading {
            display: none;
            color: #2196F3;
            font-style: italic;
            margin-top: 8px;
            text-align: center;
            padding: 8px;
            background-color: #f0f8ff;
            border-radius: 4px;
        }
        
        .error-message {
            color: #f44336;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .app-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .install-btn, .update-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .install-btn {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: white;
        }
        
        .update-btn {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
            color: white;
        }
        
        .install-btn:hover, .update-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .success-message {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            margin-top: 15px;
            display: none;
        }
        
        .validation-error {
            border-color: #f44336 !important;
            box-shadow: 0 0 0 3px rgba(244, 67, 54, 0.2) !important;
        }
        
        .map-link {
            color: #2196F3;
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            border: 1px solid #2196F3;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .map-link:hover {
            background-color: #2196F3;
            color: white;
        }
        
        .whatsapp-confirm {
            background-color: #f0f8ff;
            padding: 10px;
            border-radius: 6px;
            margin-top: 8px;
            border-left: 4px solid #2196F3;
        }
        
        .whatsapp-buttons {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }
        
        .whatsapp-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .whatsapp-yes {
            background-color: #4CAF50;
            color: white;
        }
        
        .whatsapp-no {
            background-color: #f44336;
            color: white;
        }
        
        .whatsapp-btn:hover {
            opacity: 0.9;
        }
        
        .cargo-instruction {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .payment-options {
                flex-direction: column;
                align-items: center;
            }
            
            .payment-option {
                max-width: 100%;
                width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .image-options {
                flex-direction: column;
            }
            
            .image-option-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <img src="https://i.imgur.com/SEr4lkm.png" alt="Logomarca">
        </div>
        
        <h1>Abertura de Chamados - Pessoa Jur√≠dica (Internet + Telefone Fixo)</h1>
        
        <div class="app-controls">
            <button class="install-btn" id="installButton" style="display: none;">
                üì≤ Instalar App
            </button>
            <button class="update-btn" id="updateButton" style="display: none;">
                üîÑ Atualizar App
            </button>
        </div>
        
        <div class="payment-options">
            <div class="payment-option active" data-target="debito">D√©bito em Conta</div>
            <div class="payment-option" data-target="boleto">Boleto</div>
        </div>
        
        <form id="chamadoForm">
            <!-- Formul√°rio para D√©bito em Conta -->
            <div id="debito" class="form-section active">
                <!-- Se√ß√£o de Dados da Empresa -->
                <div class="section-title">Dados da Empresa</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="razao_social" class="required">Raz√£o Social:</label>
                        <input type="text" id="razao_social" name="razao_social" required minlength="3" maxlength="200">
                        <div class="error-message" id="razao_social-error">Raz√£o Social deve ter pelo menos 3 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="nome_fantasia">Nome Fantasia:</label>
                        <input type="text" id="nome_fantasia" name="nome_fantasia" minlength="3" maxlength="200">
                        <div class="error-message" id="nome_fantasia-error">Nome Fantasia deve ter pelo menos 3 caracteres</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cnpj" class="required">CNPJ:</label>
                        <input type="text" id="cnpj" name="cnpj" required pattern="\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}" placeholder="00.000.000/0000-00" inputmode="numeric">
                        <div class="error-message" id="cnpj-error">CNPJ deve estar no formato 00.000.000/0000-00</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inscricao_estadual">Inscri√ß√£o Estadual:</label>
                        <input type="text" id="inscricao_estadual" name="inscricao_estadual" minlength="3" maxlength="50">
                        <div class="error-message" id="inscricao_estadual-error">Inscri√ß√£o Estadual deve ter pelo menos 3 caracteres</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Endere√ßo da Empresa -->
                <div class="section-title">Endere√ßo da Empresa</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cep" class="required">CEP:</label>
                        <input type="text" id="cep" name="cep" required pattern="\d{5}-\d{3}" placeholder="00000-000" inputmode="numeric">
                        <div class="error-message" id="cep-error">CEP deve estar no formato 00000-000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="numero" class="required">N√∫mero:</label>
                        <input type="text" id="numero" name="numero" required minlength="1" maxlength="10">
                        <div class="error-message" id="numero-error">N√∫mero √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <button type="button" class="gps-button" id="gps_button">
                        üìç Usar GPS para preencher endere√ßo
                    </button>
                    <div id="loading" class="loading">Buscando endere√ßo...</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="endereco" class="required">Endere√ßo:</label>
                        <input type="text" id="endereco" name="endereco" required minlength="5" maxlength="200">
                        <div class="error-message" id="endereco-error">Endere√ßo √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bairro" class="required">Bairro:</label>
                        <input type="text" id="bairro" name="bairro" required minlength="2" maxlength="100">
                        <div class="error-message" id="bairro-error">Bairro √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cidade" class="required">Cidade:</label>
                        <input type="text" id="cidade" name="cidade" required minlength="2" maxlength="100">
                        <div class="error-message" id="cidade-error">Cidade √© obrigat√≥ria</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="ponto_referencia">Ponto de Refer√™ncia:</label>
                        <input type="text" id="ponto_referencia" name="ponto_referencia" maxlength="200">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="coordenadas">Coordenadas:</label>
                        <input type="text" id="coordenadas" name="coordenadas" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="localizacao_mapa">Localiza√ß√£o (Link do Mapa):</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="localizacao_mapa" name="localizacao_mapa" readonly style="flex: 1;">
                            <a href="#" id="map_link" class="map-link" target="_blank" style="display: none;">üó∫Ô∏è Abrir Mapa</a>
                        </div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Informa√ß√µes de Contato -->
                <div class="section-title">Informa√ß√µes de Contato</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email" class="required">E-mail:</label>
                        <input type="email" id="email" name="email" required>
                        <div class="error-message" id="email-error">E-mail deve ser v√°lido</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefone_principal" class="required">Telefone Principal:</label>
                        <input type="tel" id="telefone_principal" name="telefone_principal" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="telefone_principal-error">Telefone deve estar no formato (00) 00000-0000</div>
                        <div class="whatsapp-confirm" id="whatsapp_confirm" style="display: none;">
                            <p style="margin: 0 0 8px 0; font-size: 14px;">Este n√∫mero √© do WhatsApp?</p>
                            <div class="whatsapp-buttons">
                                <button type="button" class="whatsapp-btn whatsapp-yes" onclick="copyToWhatsApp(true)">Sim</button>
                                <button type="button" class="whatsapp-btn whatsapp-no" onclick="copyToWhatsApp(false)">N√£o</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="whatsapp_principal" class="required">WhatsApp Principal:</label>
                        <input type="tel" id="whatsapp_principal" name="whatsapp_principal" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="whatsapp_principal-error">WhatsApp deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefone_secundario">Telefone Secund√°rio:</label>
                        <input type="tel" id="telefone_secundario" name="telefone_secundario" pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="telefone_secundario-error">Telefone deve estar no formato (00) 00000-0000</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="whatsapp_secundario">WhatsApp Secund√°rio:</label>
                        <input type="tel" id="whatsapp_secundario" name="whatsapp_secundario" pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="whatsapp_secundario-error">WhatsApp deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="plano" class="required">Plano:</label>
                        <select id="plano" name="plano" required>
                            <option value="">Selecione</option>
                            <option value="600MB de Internet + Fixo - R$ 119,80">600MB de Internet + Fixo - R$ 119,80</option>
                            <option value="900MB de Internet + Fixo - R$ 169,80">900MB de Internet + Fixo - R$ 169,80</option>
                        </select>
                        <div class="error-message" id="plano-error">Selecione um plano</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o do Contratante -->
                <div class="section-title">Dados do Contratante</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nome_contratante" class="required">Nome do Contratante:</label>
                        <input type="text" id="nome_contratante" name="nome_contratante" required minlength="3" maxlength="100">
                        <div class="error-message" id="nome_contratante-error">Nome do Contratante deve ter pelo menos 3 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cpf_contratante" class="required">CPF:</label>
                        <input type="text" id="cpf_contratante" name="cpf_contratante" required pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00" inputmode="numeric">
                        <div class="error-message" id="cpf_contratante-error">CPF deve estar no formato 000.000.000-00</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cargo_contratante" class="required">Cargo do Contratante:</label>
                        <select id="cargo_contratante" name="cargo_contratante" required>
                            <option value="">Selecione o cargo</option>
                            <!-- As op√ß√µes ser√£o preenchidas dinamicamente pelo JavaScript -->
                        </select>
                        <div class="error-message" id="cargo_contratante-error">Selecione um cargo</div>
                        <div class="cargo-instruction" id="cargo_instruction">
                            O cargo ser√° filtrado automaticamente com base no tipo de institui√ß√£o
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="vendedor" class="required">Vendedor:</label>
                        <input type="text" id="vendedor" name="vendedor" required minlength="2" maxlength="100">
                        <div class="error-message" id="vendedor-error">Vendedor √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_caixa">ID da Caixa:</label>
                        <input type="text" id="id_caixa" name="id_caixa" minlength="2" maxlength="50">
                        <div class="error-message" id="id_caixa-error">ID da Caixa deve ter pelo menos 2 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inserir_rede_mesh" class="required">Inserir Rede Mesh:</label>
                        <select id="inserir_rede_mesh" name="inserir_rede_mesh" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="inserir_rede_mesh-error">Selecione uma op√ß√£o</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Informa√ß√µes de Cobran√ßa Banco do Brasil -->
                <div class="section-title">Informa√ß√µes de Cobran√ßa Banco do Brasil</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="agencia" class="required">Ag√™ncia:</label>
                        <input type="text" id="agencia" name="agencia" required minlength="3" maxlength="10" inputmode="numeric">
                        <div class="error-message" id="agencia-error">Ag√™ncia √© obrigat√≥ria</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="conta" class="required">Conta:</label>
                        <input type="text" id="conta" name="conta" required minlength="3" maxlength="15" inputmode="numeric">
                        <div class="error-message" id="conta-error">Conta √© obrigat√≥ria</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="vencimento_debito" class="required">Vencimento:</label>
                    <select id="vencimento_debito" name="vencimento_debito" required>
                        <option value="">Selecione o dia</option>
                        <option value="05">Dia 05</option>
                        <option value="10">Dia 10</option>
                        <option value="15">Dia 15</option>
                        <option value="20">Dia 20</option>
                        <option value="25">Dia 25</option>
                    </select>
                    <div class="error-message" id="vencimento_debito-error">Vencimento √© obrigat√≥rio</div>
                </div>
                
                <!-- Se√ß√£o do Telefone Fixo -->
                <div class="section-title">Formul√°rio do Telefone Fixo</div>
                
                <div class="form-group">
                    <button type="button" class="autofill-button" onclick="autofillTelefoneFixo('debito')">
                        üîÑ Preencher com informa√ß√µes da Empresa
                    </button>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente_telefone" class="required">Cliente:</label>
                        <input type="text" id="cliente_telefone" name="cliente_telefone" required minlength="3" maxlength="100">
                        <div class="error-message" id="cliente_telefone-error">Nome do cliente √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cpf_telefone" class="required">CPF:</label>
                        <input type="text" id="cpf_telefone" name="cpf_telefone" required pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00" inputmode="numeric">
                        <div class="error-message" id="cpf_telefone-error">CPF deve estar no formato 000.000.000-00</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cidade_telefone" class="required">Cidade:</label>
                        <input type="text" id="cidade_telefone" name="cidade_telefone" required minlength="2" maxlength="100">
                        <div class="error-message" id="cidade_telefone-error">Cidade √© obrigat√≥ria</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bairro_telefone" class="required">Bairro:</label>
                        <input type="text" id="bairro_telefone" name="bairro_telefone" required minlength="2" maxlength="100">
                        <div class="error-message" id="bairro_telefone-error">Bairro √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="numero_endereco_telefone" class="required">N√∫mero:</label>
                        <input type="text" id="numero_endereco_telefone" name="numero_endereco_telefone" required minlength="1" maxlength="10">
                        <div class="error-message" id="numero_endereco_telefone-error">N√∫mero √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="vendedor_telefone" class="required">Vendedor:</label>
                        <input type="text" id="vendedor_telefone" name="vendedor_telefone" required minlength="2" maxlength="100">
                        <div class="error-message" id="vendedor_telefone-error">Vendedor √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="contato_telefone" class="required">Contato:</label>
                        <input type="tel" id="contato_telefone" name="contato_telefone" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="contato_telefone-error">Contato deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="taxa_telefone" class="required">Taxa:</label>
                        <input type="text" id="taxa_telefone" name="taxa_telefone" required placeholder="R$ 0,00" inputmode="decimal">
                        <div class="error-message" id="taxa_telefone-error">Taxa √© obrigat√≥ria</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_caixa_telefone">ID Caixa:</label>
                        <input type="text" id="id_caixa_telefone" name="id_caixa_telefone" minlength="2" maxlength="50">
                        <div class="error-message" id="id_caixa_telefone-error">ID da Caixa deve ter pelo menos 2 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="operadora_telefone">Operadora:</label>
                        <input type="text" id="operadora_telefone" name="operadora_telefone" minlength="2" maxlength="50">
                        <div class="error-message" id="operadora_telefone-error">Operadora deve ter pelo menos 2 caracteres</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="fidelidade_telefone" class="required">Fidelidade:</label>
                        <select id="fidelidade_telefone" name="fidelidade_telefone" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="fidelidade_telefone-error">Selecione uma op√ß√£o</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="portabilidade_telefone" class="required">Portabilidade:</label>
                        <select id="portabilidade_telefone" name="portabilidade_telefone" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="portabilidade_telefone-error">Selecione uma op√ß√£o</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="observacao_telefone">Observa√ß√£o:</label>
                    <textarea id="observacao_telefone" name="observacao_telefone" maxlength="500" placeholder="Digite observa√ß√µes adicionais aqui..."></textarea>
                </div>
            </div>
            
            <!-- Formul√°rio para Boleto -->
            <div id="boleto" class="form-section">
                <!-- Se√ß√£o de Dados da Empresa -->
                <div class="section-title">Dados da Empresa</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="razao_social_boleto" class="required">Raz√£o Social:</label>
                        <input type="text" id="razao_social_boleto" name="razao_social_boleto" required minlength="3" maxlength="200">
                        <div class="error-message" id="razao_social_boleto-error">Raz√£o Social deve ter pelo menos 3 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="nome_fantasia_boleto">Nome Fantasia:</label>
                        <input type="text" id="nome_fantasia_boleto" name="nome_fantasia_boleto" minlength="3" maxlength="200">
                        <div class="error-message" id="nome_fantasia_boleto-error">Nome Fantasia deve ter pelo menos 3 caracteres</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cnpj_boleto" class="required">CNPJ:</label>
                        <input type="text" id="cnpj_boleto" name="cnpj_boleto" required pattern="\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}" placeholder="00.000.000/0000-00" inputmode="numeric">
                        <div class="error-message" id="cnpj_boleto-error">CNPJ deve estar no formato 00.000.000/0000-00</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inscricao_estadual_boleto">Inscri√ß√£o Estadual:</label>
                        <input type="text" id="inscricao_estadual_boleto" name="inscricao_estadual_boleto" minlength="3" maxlength="50">
                        <div class="error-message" id="inscricao_estadual_boleto-error">Inscri√ß√£o Estadual deve ter pelo menos 3 caracteres</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Endere√ßo da Empresa -->
                <div class="section-title">Endere√ßo da Empresa</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cep_boleto" class="required">CEP:</label>
                        <input type="text" id="cep_boleto" name="cep_boleto" required pattern="\d{5}-\d{3}" placeholder="00000-000" inputmode="numeric">
                        <div class="error-message" id="cep_boleto-error">CEP deve estar no formato 00000-000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="numero_boleto" class="required">N√∫mero:</label>
                        <input type="text" id="numero_boleto" name="numero_boleto" required minlength="1" maxlength="10">
                        <div class="error-message" id="numero_boleto-error">N√∫mero √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <button type="button" class="gps-button" id="gps_button_boleto">
                        üìç Usar GPS para preencher endere√ßo
                    </button>
                    <div id="loading_boleto" class="loading">Buscando endere√ßo...</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="endereco_boleto" class="required">Endere√ßo:</label>
                        <input type="text" id="endereco_boleto" name="endereco_boleto" required minlength="5" maxlength="200">
                        <div class="error-message" id="endereco_boleto-error">Endere√ßo √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bairro_boleto" class="required">Bairro:</label>
                        <input type="text" id="bairro_boleto" name="bairro_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="bairro_boleto-error">Bairro √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cidade_boleto" class="required">Cidade:</label>
                        <input type="text" id="cidade_boleto" name="cidade_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="cidade_boleto-error">Cidade √© obrigat√≥ria</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="ponto_referencia_boleto">Ponto de Refer√™ncia:</label>
                        <input type="text" id="ponto_referencia_boleto" name="ponto_referencia_boleto" maxlength="200">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="coordenadas_boleto">Coordenadas:</label>
                        <input type="text" id="coordenadas_boleto" name="coordenadas_boleto" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="localizacao_mapa_boleto">Localiza√ß√£o (Link do Mapa):</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="localizacao_mapa_boleto" name="localizacao_mapa_boleto" readonly style="flex: 1;">
                            <a href="#" id="map_link_boleto" class="map-link" target="_blank" style="display: none;">üó∫Ô∏è Abrir Mapa</a>
                        </div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Informa√ß√µes de Contato -->
                <div class="section-title">Informa√ß√µes de Contato</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email_boleto" class="required">E-mail:</label>
                        <input type="email" id="email_boleto" name="email_boleto" required>
                        <div class="error-message" id="email_boleto-error">E-mail deve ser v√°lido</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefone_principal_boleto" class="required">Telefone Principal:</label>
                        <input type="tel" id="telefone_principal_boleto" name="telefone_principal_boleto" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="telefone_principal_boleto-error">Telefone deve estar no formato (00) 00000-0000</div>
                        <div class="whatsapp-confirm" id="whatsapp_confirm_boleto" style="display: none;">
                            <p style="margin: 0 0 8px 0; font-size: 14px;">Este n√∫mero √© do WhatsApp?</p>
                            <div class="whatsapp-buttons">
                                <button type="button" class="whatsapp-btn whatsapp-yes" onclick="copyToWhatsAppBoleto(true)">Sim</button>
                                <button type="button" class="whatsapp-btn whatsapp-no" onclick="copyToWhatsAppBoleto(false)">N√£o</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="whatsapp_principal_boleto" class="required">WhatsApp Principal:</label>
                        <input type="tel" id="whatsapp_principal_boleto" name="whatsapp_principal_boleto" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="whatsapp_principal_boleto-error">WhatsApp deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="telefone_secundario_boleto">Telefone Secund√°rio:</label>
                        <input type="tel" id="telefone_secundario_boleto" name="telefone_secundario_boleto" pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="telefone_secundario_boleto-error">Telefone deve estar no formato (00) 00000-0000</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="whatsapp_secundario_boleto">WhatsApp Secund√°rio:</label>
                        <input type="tel" id="whatsapp_secundario_boleto" name="whatsapp_secundario_boleto" pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="whatsapp_secundario_boleto-error">WhatsApp deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="plano_boleto" class="required">Plano:</label>
                        <select id="plano_boleto" name="plano_boleto" required>
                            <option value="">Selecione</option>
                            <option value="600MB de Internet + Fixo - R$ 139,80">600MB de Internet + Fixo - R$ 139,80</option>
                            <option value="900MB de Internet + Fixo - R$ 189,80">900MB de Internet + Fixo - R$ 189,80</option>
                        </select>
                        <div class="error-message" id="plano_boleto-error">Selecione um plano</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o do Contratante -->
                <div class="section-title">Dados do Contratante</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nome_contratante_boleto" class="required">Nome do Contratante:</label>
                        <input type="text" id="nome_contratante_boleto" name="nome_contratante_boleto" required minlength="3" maxlength="100">
                        <div class="error-message" id="nome_contratante_boleto-error">Nome do Contratante deve ter pelo menos 3 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cpf_contratante_boleto" class="required">CPF:</label>
                        <input type="text" id="cpf_contratante_boleto" name="cpf_contratante_boleto" required pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00" inputmode="numeric">
                        <div class="error-message" id="cpf_contratante_boleto-error">CPF deve estar no formato 000.000.000-00</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cargo_contratante_boleto" class="required">Cargo do Contratante:</label>
                        <select id="cargo_contratante_boleto" name="cargo_contratante_boleto" required>
                            <option value="">Selecione o cargo</option>
                            <!-- As op√ß√µes ser√£o preenchidas dinamicamente pelo JavaScript -->
                        </select>
                        <div class="error-message" id="cargo_contratante_boleto-error">Selecione um cargo</div>
                        <div class="cargo-instruction" id="cargo_instruction_boleto">
                            O cargo ser√° filtrado automaticamente com base no tipo de institui√ß√£o
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="vendedor_boleto" class="required">Vendedor:</label>
                        <input type="text" id="vendedor_boleto" name="vendedor_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="vendedor_boleto-error">Vendedor √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_caixa_boleto">ID da Caixa:</label>
                        <input type="text" id="id_caixa_boleto" name="id_caixa_boleto" minlength="2" maxlength="50">
                        <div class="error-message" id="id_caixa_boleto-error">ID da Caixa deve ter pelo menos 2 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="inserir_rede_mesh_boleto" class="required">Inserir Rede Mesh:</label>
                        <select id="inserir_rede_mesh_boleto" name="inserir_rede_mesh_boleto" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="inserir_rede_mesh_boleto-error">Selecione uma op√ß√£o</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de Informa√ß√µes de Cobran√ßa -->
                <div class="section-title">Informa√ß√µes de Cobran√ßa</div>
                
                <div class="form-group">
                    <label for="vencimento_boleto" class="required">Vencimento:</label>
                    <select id="vencimento_boleto" name="vencimento_boleto" required>
                        <option value="">Selecione o dia</option>
                        <option value="01">Dia 01</option>
                        <option value="05">Dia 05</option>
                        <option value="08">Dia 08</option>
                        <option value="10">Dia 10</option>
                        <option value="12">Dia 12</option>
                        <option value="15">Dia 15</option>
                        <option value="20">Dia 20</option>
                    </select>
                    <div class="error-message" id="vencimento_boleto-error">Vencimento √© obrigat√≥rio</div>
                </div>
                
                <!-- Se√ß√£o do Telefone Fixo -->
                <div class="section-title">Formul√°rio do Telefone Fixo</div>
                
                <div class="form-group">
                    <button type="button" class="autofill-button" onclick="autofillTelefoneFixo('boleto')">
                        üîÑ Preencher com informa√ß√µes da Empresa
                    </button>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente_telefone_boleto" class="required">Cliente:</label>
                        <input type="text" id="cliente_telefone_boleto" name="cliente_telefone_boleto" required minlength="3" maxlength="100">
                        <div class="error-message" id="cliente_telefone_boleto-error">Nome do cliente √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cpf_telefone_boleto" class="required">CPF:</label>
                        <input type="text" id="cpf_telefone_boleto" name="cpf_telefone_boleto" required pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00" inputmode="numeric">
                        <div class="error-message" id="cpf_telefone_boleto-error">CPF deve estar no formato 000.000.000-00</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="cidade_telefone_boleto" class="required">Cidade:</label>
                        <input type="text" id="cidade_telefone_boleto" name="cidade_telefone_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="cidade_telefone_boleto-error">Cidade √© obrigat√≥ria</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bairro_telefone_boleto" class="required">Bairro:</label>
                        <input type="text" id="bairro_telefone_boleto" name="bairro_telefone_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="bairro_telefone_boleto-error">Bairro √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="numero_endereco_telefone_boleto" class="required">N√∫mero:</label>
                        <input type="text" id="numero_endereco_telefone_boleto" name="numero_endereco_telefone_boleto" required minlength="1" maxlength="10">
                        <div class="error-message" id="numero_endereco_telefone_boleto-error">N√∫mero √© obrigat√≥rio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="vendedor_telefone_boleto" class="required">Vendedor:</label>
                        <input type="text" id="vendedor_telefone_boleto" name="vendedor_telefone_boleto" required minlength="2" maxlength="100">
                        <div class="error-message" id="vendedor_telefone_boleto-error">Vendedor √© obrigat√≥rio</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="contato_telefone_boleto" class="required">Contato:</label>
                        <input type="tel" id="contato_telefone_boleto" name="contato_telefone_boleto" required pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000" inputmode="numeric">
                        <div class="error-message" id="contato_telefone_boleto-error">Contato deve estar no formato (00) 00000-0000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="taxa_telefone_boleto" class="required">Taxa de Instala√ß√£o:</label>
                        <input type="text" id="taxa_telefone_boleto" name="taxa_telefone_boleto" required placeholder="R$ 0,00" inputmode="decimal">
                        <div class="error-message" id="taxa_telefone_boleto-error">Taxa √© obrigat√≥ria</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_caixa_telefone_boleto">ID Caixa:</label>
                        <input type="text" id="id_caixa_telefone_boleto" name="id_caixa_telefone_boleto" minlength="2" maxlength="50">
                        <div class="error-message" id="id_caixa_telefone_boleto-error">ID da Caixa deve ter pelo menos 2 caracteres</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="operadora_telefone_boleto">Operadora:</label>
                        <input type="text" id="operadora_telefone_boleto" name="operadora_telefone_boleto" minlength="2" maxlength="50">
                        <div class="error-message" id="operadora_telefone_boleto-error">Operadora deve ter pelo menos 2 caracteres</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="fidelidade_telefone_boleto" class="required">FIDELIDADE:</label>
                        <select id="fidelidade_telefone_boleto" name="fidelidade_telefone_boleto" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="fidelidade_telefone_boleto-error">Selecione uma op√ß√£o</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="portabilidade_telefone_boleto" class="required">Portabilidade:</label>
                        <select id="portabilidade_telefone_boleto" name="portabilidade_telefone_boleto" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                        <div class="error-message" id="portabilidade_telefone_boleto-error">Selecione uma op√ß√£o</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="observacao_telefone_boleto">Observa√ß√£o:</label>
                    <textarea id="observacao_telefone_boleto" name="observacao_telefone_boleto" maxlength="500" placeholder="Digite observa√ß√µes adicionais aqui..."></textarea>
                </div>
            </div>
            
            <div class="success-message" id="successMessage">
                ‚úÖ Dados copiados com sucesso! Agora voc√™ pode colar no WhatsApp.
            </div>
            
            <div class="action-buttons">
                <button type="button" class="copy-btn" id="copyButton">
                    üìã Copiar
                </button>
                <button type="button" class="save-btn" id="saveButton">
                    üíæ Salvar PDF
                </button>
                <button type="button" class="clear-btn" id="clearButton">
                    üóëÔ∏è Limpar Formul√°rio
                </button>
            </div>
        </form>
    </div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        const installButton = document.getElementById('installButton');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.style.display = 'block';
            
            installButton.addEventListener('click', () => {
                installButton.style.display = 'none';
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });

        // Check for updates
        const updateButton = document.getElementById('updateButton');
        let waitingWorker = null;

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                window.location.reload();
            });

            navigator.serviceWorker.register('service-worker.js').then(registration => {
                registration.addEventListener('updatefound', () => {
                    const newWorker = registration.installing;
                    newWorker.addEventListener('statechange', () => {
                        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                            updateButton.style.display = 'block';
                            waitingWorker = newWorker;
                        }
                    });
                });
            });

            updateButton.addEventListener('click', () => {
                if (waitingWorker) {
                    waitingWorker.postMessage({ type: 'SKIP_WAITING' });
                }
                updateButton.style.display = 'none';
            });
        }

        // Alternar entre as op√ß√µes de pagamento
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.payment-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                
                this.classList.add('active');
                
                document.querySelectorAll('.form-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                const targetId = this.getAttribute('data-target');
                document.getElementById(targetId).classList.add('active');
            });
        });
        
        // Formata√ß√£o autom√°tica do CNPJ
        function formatCNPJ(cnpj) {
            cnpj = cnpj.replace(/\D/g, '');
            cnpj = cnpj.replace(/^(\d{2})(\d)/, '$1.$2');
            cnpj = cnpj.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
            cnpj = cnpj.replace(/\.(\d{3})(\d)/, '.$1/$2');
            cnpj = cnpj.replace(/(\d{4})(\d)/, '$1-$2');
            return cnpj;
        }
        
        // Formata√ß√£o autom√°tica do CPF
        function formatCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            return cpf;
        }
        
        // Formata√ß√£o autom√°tica do CEP
        function formatCEP(cep) {
            cep = cep.replace(/\D/g, '');
            cep = cep.replace(/^(\d{5})(\d)/, '$1-$2');
            return cep;
        }
        
        // Formata√ß√£o autom√°tica do telefone
        function formatPhone(phone) {
            phone = phone.replace(/\D/g, '');
            phone = phone.replace(/^(\d{2})(\d)/g, '($1) $2');
            phone = phone.replace(/(\d{5})(\d)/, '$1-$2');
            return phone;
        }
        
        // Formata√ß√£o autom√°tica da taxa de instala√ß√£o
        function formatCurrency(value) {
            value = value.replace(/\D/g, '');
            if (value === '') return 'R$ 0,00';
            value = (parseInt(value) / 100).toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            return 'R$ ' + value;
        }
        
        // Formata√ß√£o de data com valida√ß√£o de 18 anos ou mais
        function formatDate(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2);
            }
            if (value.length >= 5) {
                value = value.substring(0, 5) + '/' + value.substring(5, 9);
            }
            input.value = value;
        }
        
        // Aplicar formata√ß√£o em tempo real para campos
        document.getElementById('cnpj').addEventListener('input', function(e) {
            this.value = formatCNPJ(this.value);
        });
        
        document.getElementById('cnpj_boleto').addEventListener('input', function(e) {
            this.value = formatCNPJ(this.value);
        });
        
        document.getElementById('cpf_telefone').addEventListener('input', function(e) {
            this.value = formatCPF(this.value);
        });
        
        document.getElementById('cpf_telefone_boleto').addEventListener('input', function(e) {
            this.value = formatCPF(this.value);
        });
        
        document.getElementById('cpf_contratante').addEventListener('input', function(e) {
            this.value = formatCPF(this.value);
        });
        
        document.getElementById('cpf_contratante_boleto').addEventListener('input', function(e) {
            this.value = formatCPF(this.value);
        });
        
        document.getElementById('contato_telefone').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('contato_telefone_boleto').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('taxa_telefone').addEventListener('input', function(e) {
            this.value = formatCurrency(this.value);
        });
        
        document.getElementById('taxa_telefone_boleto').addEventListener('input', function(e) {
            this.value = formatCurrency(this.value);
        });
        
        // Formata√ß√£o original
        document.getElementById('cep').addEventListener('input', function(e) {
            this.value = formatCEP(this.value);
        });
        
        document.getElementById('cep_boleto').addEventListener('input', function(e) {
            this.value = formatCEP(this.value);
        });
        
        document.getElementById('telefone_principal').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
            if (this.value.length === 15) {
                document.getElementById('whatsapp_confirm').style.display = 'block';
            }
        });
        
        document.getElementById('telefone_principal_boleto').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
            if (this.value.length === 15) {
                document.getElementById('whatsapp_confirm_boleto').style.display = 'block';
            }
        });
        
        document.getElementById('whatsapp_principal').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('whatsapp_principal_boleto').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('telefone_secundario').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('telefone_secundario_boleto').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('whatsapp_secundario').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        document.getElementById('whatsapp_secundario_boleto').addEventListener('input', function(e) {
            this.value = formatPhone(this.value);
        });
        
        // Fun√ß√£o para copiar n√∫mero para WhatsApp
        function copyToWhatsApp(isWhatsApp) {
            const telefonePrincipal = document.getElementById('telefone_principal').value;
            const whatsappPrincipal = document.getElementById('whatsapp_principal');
            
            if (isWhatsApp) {
                whatsappPrincipal.value = telefonePrincipal;
            }
            
            document.getElementById('whatsapp_confirm').style.display = 'none';
        }
        
        function copyToWhatsAppBoleto(isWhatsApp) {
            const telefonePrincipal = document.getElementById('telefone_principal_boleto').value;
            const whatsappPrincipal = document.getElementById('whatsapp_principal_boleto');
            
            if (isWhatsApp) {
                whatsappPrincipal.value = telefonePrincipal;
            }
            
            document.getElementById('whatsapp_confirm_boleto').style.display = 'none';
        }
        
        // Valida√ß√£o de iniciais mai√∫sculas
        function capitalizeWords(text) {
            const wordsToIgnore = ['de', 'da', 'do', 'e', 'com', 'para', 'em', 'na', 'no', 'das', 'dos'];
            return text.replace(/\w\S*/g, function(txt) {
                if (wordsToIgnore.includes(txt.toLowerCase())) {
                    return txt.toLowerCase();
                }
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            });
        }
        
        // Aplicar capitaliza√ß√£o em campos de texto
        const textFields = document.querySelectorAll('input[type="text"]:not([id*="cnpj"]):not([id*="cpf"]):not([id*="cep"]):not([id*="taxa"]):not([readonly]):not([id*="data_nascimento"])');
        textFields.forEach(field => {
            field.addEventListener('blur', function() {
                if (this.value.trim() !== '') {
                    this.value = capitalizeWords(this.value);
                }
            });
        });
        
        // Fun√ß√£o para obter localiza√ß√£o via GPS
        function getLocation(isBoleto = false) {
            const loadingElement = isBoleto 
                ? document.getElementById('loading_boleto') 
                : document.getElementById('loading');
                
            if (loadingElement) loadingElement.style.display = 'block';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        if (isBoleto) {
                            document.getElementById('coordenadas_boleto').value = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                            document.getElementById('localizacao_mapa_boleto').value = `https://www.google.com/maps?q=${lat},${lng}`;
                            document.getElementById('map_link_boleto').href = `https://www.google.com/maps?q=${lat},${lng}`;
                            document.getElementById('map_link_boleto').style.display = 'inline-flex';
                        } else {
                            document.getElementById('coordenadas').value = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                            document.getElementById('localizacao_mapa').value = `https://www.google.com/maps?q=${lat},${lng}`;
                            document.getElementById('map_link').href = `https://www.google.com/maps?q=${lat},${lng}`;
                            document.getElementById('map_link').style.display = 'inline-flex';
                        }
                        
                        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&addressdetails=1&zoom=18`)
                            .then(response => response.json())
                            .then(data => {
                                if (data && data.address) {
                                    const address = data.address;
                                    
                                    if (isBoleto) {
                                        if (address.postcode) document.getElementById('cep_boleto').value = formatCEP(address.postcode);
                                        if (address.house_number) document.getElementById('numero_boleto').value = address.house_number;
                                        if (address.road) document.getElementById('endereco_boleto').value = address.road;
                                        if (address.suburb || address.neighbourhood) document.getElementById('bairro_boleto').value = address.suburb || address.neighbourhood;
                                        if (address.city || address.town || address.village) document.getElementById('cidade_boleto').value = address.city || address.town || address.village;
                                    } else {
                                        if (address.postcode) document.getElementById('cep').value = formatCEP(address.postcode);
                                        if (address.house_number) document.getElementById('numero').value = address.house_number;
                                        if (address.road) document.getElementById('endereco').value = address.road;
                                        if (address.suburb || address.neighbourhood) document.getElementById('bairro').value = address.suburb || address.neighbourhood;
                                        if (address.city || address.town || address.village) document.getElementById('cidade').value = address.city || address.town || address.village;
                                    }
                                    
                                    if (loadingElement) loadingElement.style.display = 'none';
                                    alert('Endere√ßo preenchido automaticamente com sucesso!');
                                } else {
                                    throw new Error('Endere√ßo n√£o encontrado');
                                }
                            })
                            .catch(error => {
                                console.error('Erro ao obter endere√ßo:', error);
                                if (loadingElement) loadingElement.style.display = 'none';
                                alert('N√£o foi poss√≠vel obter o endere√ßo completo. Por favor, preencha manualmente os campos que faltaram.');
                            });
                    }, 
                    function(error) {
                        if (loadingElement) loadingElement.style.display = 'none';
                        let errorMessage = 'Erro ao obter localiza√ß√£o: ';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage += 'Usu√°rio negou a solicita√ß√£o de Geolocaliza√ß√£o.';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage += 'As informa√ß√µes de localiza√ß√£o n√£o est√£o dispon√≠veis.';
                                break;
                            case error.TIMEOUT:
                                errorMessage += 'A solicita√ß√£o de localiza√ß√£o expirou.';
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMessage += 'Ocorreu um erro desconhecido.';
                                break;
                        }
                        alert(errorMessage);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 60000
                    }
                );
            } else {
                if (loadingElement) loadingElement.style.display = 'none';
                alert('Geolocaliza√ß√£o n√£o √© suportada por este navegador.');
            }
        }
        
        // Adicionar eventos aos bot√µes de GPS
        document.getElementById('gps_button').addEventListener('click', function() {
            getLocation(false);
        });
        
        document.getElementById('gps_button_boleto').addEventListener('click', function() {
            getLocation(true);
        });
        
        // Fun√ß√£o para detectar o tipo de institui√ß√£o e atualizar os cargos dispon√≠veis
        function updateCargoOptions() {
            // Fun√ß√£o para ambos os formul√°rios
            function updateForForm(isBoleto = false) {
                const prefix = isBoleto ? '_boleto' : '';
                const razaoSocialField = document.getElementById('razao_social' + prefix);
                const nomeFantasiaField = document.getElementById('nome_fantasia' + prefix);
                const cargoSelect = document.getElementById('cargo_contratante' + prefix);
                const instructionDiv = document.getElementById('cargo_instruction' + prefix);
                
                if (!razaoSocialField || !cargoSelect) return;
                
                const razaoSocial = razaoSocialField.value.toLowerCase();
                const nomeFantasia = nomeFantasiaField ? nomeFantasiaField.value.toLowerCase() : '';
                
                let cargoOptions = [];
                let instructionText = '';
                
                // Detectar tipo de institui√ß√£o
                if (razaoSocial.includes('igreja') || nomeFantasia.includes('igreja') || 
                    razaoSocial.includes('par√≥quia') || nomeFantasia.includes('par√≥quia') ||
                    razaoSocial.includes('templo') || nomeFantasia.includes('templo')) {
                    cargoOptions = ['Pastor', 'Presidente', 'Tesoureiro'];
                    instructionText = 'Igreja detectada: somente Pastor, Presidente ou Tesoureiro s√£o aceitos.';
                } else if (razaoSocial.includes('associa√ß√£o') || nomeFantasia.includes('associa√ß√£o') ||
                          razaoSocial.includes('sindicato') || nomeFantasia.includes('sindicato') ||
                          razaoSocial.includes('associacao') || nomeFantasia.includes('associacao')) {
                    cargoOptions = ['Presidente', 'Tesoureiro'];
                    instructionText = 'Associa√ß√£o ou Sindicato detectado: somente Presidente ou Tesoureiro s√£o aceitos.';
                } else if (razaoSocial.includes('escola') || nomeFantasia.includes('escola') ||
                          razaoSocial.includes('col√©gio') || nomeFantasia.includes('col√©gio') ||
                          razaoSocial.includes('colegio') || nomeFantasia.includes('colegio') ||
                          razaoSocial.includes('faculdade') || nomeFantasia.includes('faculdade') ||
                          razaoSocial.includes('universidade') || nomeFantasia.includes('universidade')) {
                    cargoOptions = ['Diretor', 'Coordenador'];
                    instructionText = 'Escola detectada: somente Diretor ou Coordenador s√£o aceitos.';
                } else {
                    cargoOptions = ['Administrador', 'Assistente administrativo', 'Diretor', 'Gerente', 'Propriet√°rio', 'S√≥cio'];
                    instructionText = 'Outras institui√ß√µes: Administrador, Assistente administrativo, Diretor, Gerente, Propriet√°rio ou S√≥cio s√£o aceitos.';
                }
                
                // Salvar o valor atual antes de atualizar
                const currentValue = cargoSelect.value;
                
                // Limpar e preencher as op√ß√µes
                cargoSelect.innerHTML = '<option value="">Selecione o cargo</option>';
                cargoOptions.forEach(cargo => {
                    const option = document.createElement('option');
                    option.value = cargo;
                    option.textContent = cargo;
                    cargoSelect.appendChild(option);
                });
                
                // Restaurar o valor anterior se ainda estiver dispon√≠vel
                if (cargoOptions.includes(currentValue)) {
                    cargoSelect.value = currentValue;
                }
                
                // Atualizar texto de instru√ß√£o
                if (instructionDiv) {
                    instructionDiv.textContent = instructionText;
                }
            }
            
            // Atualizar para ambos os formul√°rios
            updateForForm(false); // D√©bito
            updateForForm(true); // Boleto
        }
        
        // Adicionar eventos para detectar mudan√ßas nos campos de institui√ß√£o
        document.getElementById('razao_social').addEventListener('input', updateCargoOptions);
        document.getElementById('nome_fantasia').addEventListener('input', updateCargoOptions);
        document.getElementById('razao_social_boleto').addEventListener('input', updateCargoOptions);
        document.getElementById('nome_fantasia_boleto').addEventListener('input', updateCargoOptions);
        
        // Inicializar os cargos na primeira execu√ß√£o
        document.addEventListener('DOMContentLoaded', updateCargoOptions);
        
        // NOVA FUN√á√ÉO: Preencher automaticamente formul√°rio do telefone fixo
        function autofillTelefoneFixo(formType) {
            const isBoleto = formType === 'boleto';
            
            if (isBoleto) {
                // Preencher campos do formul√°rio boleto
                document.getElementById('cliente_telefone_boleto').value = 
                    document.getElementById('nome_fantasia_boleto').value || 
                    document.getElementById('razao_social_boleto').value;
                document.getElementById('cpf_telefone_boleto').value = document.getElementById('cpf_contratante_boleto').value;
                document.getElementById('cidade_telefone_boleto').value = document.getElementById('cidade_boleto').value;
                document.getElementById('bairro_telefone_boleto').value = document.getElementById('bairro_boleto').value;
                document.getElementById('numero_endereco_telefone_boleto').value = document.getElementById('numero_boleto').value;
                document.getElementById('vendedor_telefone_boleto').value = document.getElementById('vendedor_boleto').value;
                document.getElementById('contato_telefone_boleto').value = document.getElementById('telefone_principal_boleto').value;
            } else {
                // Preencher campos do formul√°rio d√©bito
                document.getElementById('cliente_telefone').value = 
                    document.getElementById('nome_fantasia').value || 
                    document.getElementById('razao_social').value;
                document.getElementById('cpf_telefone').value = document.getElementById('cpf_contratante').value;
                document.getElementById('cidade_telefone').value = document.getElementById('cidade').value;
                document.getElementById('bairro_telefone').value = document.getElementById('bairro').value;
                document.getElementById('numero_endereco_telefone').value = document.getElementById('numero').value;
                document.getElementById('vendedor_telefone').value = document.getElementById('vendedor').value;
                document.getElementById('contato_telefone').value = document.getElementById('telefone_principal').value;
            }
            
            alert('Campos do formul√°rio de telefone fixo preenchidos automaticamente!');
        }
        
        // Valida√ß√£o em tempo real
        function setupValidation(fieldId, errorId, validationFn) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            
            if (!field || !error) return;
            
            field.addEventListener('blur', function() {
                if (!validationFn(this.value)) {
                    error.style.display = 'block';
                    this.classList.add('validation-error');
                } else {
                    error.style.display = 'none';
                    this.classList.remove('validation-error');
                }
            });
            
            field.addEventListener('input', function() {
                if (validationFn(this.value)) {
                    error.style.display = 'none';
                    this.classList.remove('validation-error');
                }
            });
        }
        
        // Configurar valida√ß√µes para campos PJ
        setupValidation('razao_social', 'razao_social-error', value => value.length >= 3);
        setupValidation('nome_fantasia', 'nome_fantasia-error', value => value.length === 0 || value.length >= 3);
        setupValidation('cnpj', 'cnpj-error', value => /^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/.test(value));
        setupValidation('inscricao_estadual', 'inscricao_estadual-error', value => value.length === 0 || value.length >= 3);
        setupValidation('cep', 'cep-error', value => /^\d{5}-\d{3}$/.test(value));
        setupValidation('numero', 'numero-error', value => value.length >= 1);
        setupValidation('endereco', 'endereco-error', value => value.length >= 5);
        setupValidation('bairro', 'bairro-error', value => value.length >= 2);
        setupValidation('cidade', 'cidade-error', value => value.length >= 2);
        setupValidation('email', 'email-error', value => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value));
        setupValidation('telefone_principal', 'telefone_principal-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('whatsapp_principal', 'whatsapp_principal-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('plano', 'plano-error', value => value.length > 0);
        setupValidation('nome_contratante', 'nome_contratante-error', value => value.length >= 3);
        setupValidation('cpf_contratante', 'cpf_contratante-error', value => /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(value));
        setupValidation('cargo_contratante', 'cargo_contratante-error', value => value.length > 0);
        setupValidation('vendedor', 'vendedor-error', value => value.length >= 2);
        setupValidation('id_caixa', 'id_caixa-error', value => value.length === 0 || value.length >= 2);
        setupValidation('inserir_rede_mesh', 'inserir_rede_mesh-error', value => value.length > 0);
        setupValidation('agencia', 'agencia-error', value => value.length >= 3);
        setupValidation('conta', 'conta-error', value => value.length >= 3);
        setupValidation('vencimento_debito', 'vencimento_debito-error', value => value.length > 0);
        
        // Configurar valida√ß√µes para campos do telefone fixo (d√©bito)
        setupValidation('cliente_telefone', 'cliente_telefone-error', value => value.length >= 3);
        setupValidation('cpf_telefone', 'cpf_telefone-error', value => /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(value));
        setupValidation('cidade_telefone', 'cidade_telefone-error', value => value.length >= 2);
        setupValidation('bairro_telefone', 'bairro_telefone-error', value => value.length >= 2);
        setupValidation('numero_endereco_telefone', 'numero_endereco_telefone-error', value => value.length >= 1);
        setupValidation('vendedor_telefone', 'vendedor_telefone-error', value => value.length >= 2);
        setupValidation('contato_telefone', 'contato_telefone-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('taxa_telefone', 'taxa_telefone-error', value => value.length > 0);
        setupValidation('fidelidade_telefone', 'fidelidade_telefone-error', value => value.length > 0);
        setupValidation('portabilidade_telefone', 'portabilidade_telefone-error', value => value.length > 0);
        
        // Configurar valida√ß√µes para o formul√°rio boleto
        setupValidation('razao_social_boleto', 'razao_social_boleto-error', value => value.length >= 3);
        setupValidation('nome_fantasia_boleto', 'nome_fantasia_boleto-error', value => value.length === 0 || value.length >= 3);
        setupValidation('cnpj_boleto', 'cnpj_boleto-error', value => /^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/.test(value));
        setupValidation('inscricao_estadual_boleto', 'inscricao_estadual_boleto-error', value => value.length === 0 || value.length >= 3);
        setupValidation('cep_boleto', 'cep_boleto-error', value => /^\d{5}-\d{3}$/.test(value));
        setupValidation('numero_boleto', 'numero_boleto-error', value => value.length >= 1);
        setupValidation('endereco_boleto', 'endereco_boleto-error', value => value.length >= 5);
        setupValidation('bairro_boleto', 'bairro_boleto-error', value => value.length >= 2);
        setupValidation('cidade_boleto', 'cidade_boleto-error', value => value.length >= 2);
        setupValidation('email_boleto', 'email_boleto-error', value => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value));
        setupValidation('telefone_principal_boleto', 'telefone_principal_boleto-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('whatsapp_principal_boleto', 'whatsapp_principal_boleto-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('plano_boleto', 'plano_boleto-error', value => value.length > 0);
        setupValidation('nome_contratante_boleto', 'nome_contratante_boleto-error', value => value.length >= 3);
        setupValidation('cpf_contratante_boleto', 'cpf_contratante_boleto-error', value => /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(value));
        setupValidation('cargo_contratante_boleto', 'cargo_contratante_boleto-error', value => value.length > 0);
        setupValidation('vendedor_boleto', 'vendedor_boleto-error', value => value.length >= 2);
        setupValidation('id_caixa_boleto', 'id_caixa_boleto-error', value => value.length === 0 || value.length >= 2);
        setupValidation('inserir_rede_mesh_boleto', 'inserir_rede_mesh_boleto-error', value => value.length > 0);
        setupValidation('vencimento_boleto', 'vencimento_boleto-error', value => value.length > 0);
        
        // Configurar valida√ß√µes para campos do telefone fixo (boleto)
        setupValidation('cliente_telefone_boleto', 'cliente_telefone_boleto-error', value => value.length >= 3);
        setupValidation('cpf_telefone_boleto', 'cpf_telefone_boleto-error', value => /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(value));
        setupValidation('cidade_telefone_boleto', 'cidade_telefone_boleto-error', value => value.length >= 2);
        setupValidation('bairro_telefone_boleto', 'bairro_telefone_boleto-error', value => value.length >= 2);
        setupValidation('numero_endereco_telefone_boleto', 'numero_endereco_telefone_boleto-error', value => value.length >= 1);
        setupValidation('vendedor_telefone_boleto', 'vendedor_telefone_boleto-error', value => value.length >= 2);
        setupValidation('contato_telefone_boleto', 'contato_telefone_boleto-error', value => /^\(\d{2}\) \d{5}-\d{4}$/.test(value));
        setupValidation('taxa_telefone_boleto', 'taxa_telefone_boleto-error', value => value.length > 0);
        setupValidation('fidelidade_telefone_boleto', 'fidelidade_telefone_boleto-error', value => value.length > 0);
        setupValidation('portabilidade_telefone_boleto', 'portabilidade_telefone_boleto-error', value => value.length > 0);
        
        // Fun√ß√£o para validar todo o formul√°rio
        function validateForm(isBoleto = false) {
            let isValid = true;
            const prefix = isBoleto ? '_boleto' : '';
            
            // Lista de campos obrigat√≥rios
            const requiredFields = [
                'razao_social', 'cnpj', 'cep', 'numero', 'endereco', 'bairro', 
                'cidade', 'email', 'telefone_principal', 'whatsapp_principal',
                'plano', 'nome_contratante', 'cpf_contratante', 'cargo_contratante',
                'vendedor', 'inserir_rede_mesh'
            ];
            
            // Adicionar campos espec√≠ficos do d√©bito
            if (!isBoleto) {
                requiredFields.push('agencia', 'conta', 'vencimento_debito');
            } else {
                requiredFields.push('vencimento_boleto');
            }
            
            // Adicionar campos do telefone fixo
            const telefoneFields = [
                'cliente_telefone', 'cpf_telefone', 'cidade_telefone', 'bairro_telefone',
                'numero_endereco_telefone', 'vendedor_telefone', 'contato_telefone',
                'taxa_telefone', 'fidelidade_telefone', 'portabilidade_telefone'
            ];
            
            requiredFields.push(...telefoneFields);
            
            // Validar cada campo
            requiredFields.forEach(field => {
                const fieldId = field + prefix;
                const fieldElement = document.getElementById(fieldId);
                const errorElement = document.getElementById(fieldId + '-error');
                
                if (fieldElement) {
                    let fieldValid = true;
                    
                    // Verifica√ß√µes espec√≠ficas por tipo de campo
                    if (field.includes('cnpj')) {
                        fieldValid = /^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/.test(fieldElement.value);
                    } else if (field.includes('cpf')) {
                        fieldValid = /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(fieldElement.value);
                    } else if (field === 'cep') {
                        fieldValid = /^\d{5}-\d{3}$/.test(fieldElement.value);
                    } else if (field.includes('telefone_principal') || field.includes('whatsapp_principal') || field.includes('contato_telefone')) {
                        fieldValid = /^\(\d{2}\) \d{5}-\d{4}$/.test(fieldElement.value);
                    } else if (field === 'email') {
                        fieldValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(fieldElement.value);
                    } else if (field === 'razao_social' || field === 'nome_contratante' || field === 'cliente_telefone') {
                        fieldValid = fieldElement.value.length >= 3;
                    } else if (['endereco', 'bairro', 'cidade', 'vendedor', 'cidade_telefone', 'bairro_telefone', 'vendedor_telefone'].includes(field)) {
                        fieldValid = fieldElement.value.length >= 2;
                    } else if (['agencia', 'conta'].includes(field)) {
                        fieldValid = fieldElement.value.length >= 3;
                    } else if (['numero', 'numero_endereco_telefone'].includes(field)) {
                        fieldValid = fieldElement.value.length >= 1;
                    } else if (['taxa_telefone', 'fidelidade_telefone', 'portabilidade_telefone', 'inserir_rede_mesh', 'cargo_contratante', 'vencimento_debito', 'vencimento_boleto', 'plano'].includes(field)) {
                        fieldValid = fieldElement.value.length > 0;
                    } else {
                        fieldValid = fieldElement.value.length > 0;
                    }
                    
                    if (!fieldValid) {
                        isValid = false;
                        fieldElement.classList.add('validation-error');
                        if (errorElement) errorElement.style.display = 'block';
                    } else {
                        fieldElement.classList.remove('validation-error');
                        if (errorElement) errorElement.style.display = 'none';
                    }
                }
            });
            
            return isValid;
        }
        
        // Fun√ß√£o para copiar dados do formul√°rio - COM VALIDA√á√ÉO
        document.getElementById('copyButton').addEventListener('click', function() {
            const activeForm = document.querySelector('.form-section.active').id;
            const isBoleto = activeForm === 'boleto';
            
            // Validar formul√°rio antes de copiar
            if (!validateForm(isBoleto)) {
                alert('Por favor, preencha todos os campos obrigat√≥rios corretamente antes de copiar.');
                return;
            }
            
            let formData = '';
            
            if (activeForm === 'debito') {
                const fields = document.querySelectorAll('#debito input, #debito select, #debito textarea');
                fields.forEach(field => {
                    if (field.type !== 'file' && field.type !== 'button' && !field.classList.contains('gps-button') && !field.classList.contains('autofill-button') && field.id !== 'coordenadas' && field.id !== 'localizacao_mapa') {
                        const label = document.querySelector(`label[for="${field.id}"]`);
                        const labelText = label ? label.textContent.replace(' *', '') : field.name;
                        if (field.value) {
                            formData += `${labelText}: ${field.value}\n`;
                        }
                    }
                });
            } else {
                const fields = document.querySelectorAll('#boleto input, #boleto select, #boleto textarea');
                fields.forEach(field => {
                    if (field.type !== 'file' && field.type !== 'button' && !field.classList.contains('gps-button') && !field.classList.contains('autofill-button') && field.id !== 'coordenadas_boleto' && field.id !== 'localizacao_mapa_boleto') {
                        const label = document.querySelector(`label[for="${field.id}"]`);
                        const labelText = label ? label.textContent.replace(' *', '') : field.name;
                        if (field.value) {
                            formData += `${labelText}: ${field.value}\n`;
                        }
                    }
                });
            }
            
            navigator.clipboard.writeText(formData)
                .then(() => {
                    const successMessage = document.getElementById('successMessage');
                    successMessage.style.display = 'block';
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                    }, 5000);
                })
                .catch(err => {
                    console.error('Erro ao copiar: ', err);
                    alert('Erro ao copiar dados. Tente novamente.');
                });
        });
        
        // Fun√ß√£o para salvar como PDF - SIMPLIFICADA E FUNCIONAL
        document.getElementById('saveButton').addEventListener('click', function() {
            const activeForm = document.querySelector('.form-section.active').id;
            const isBoleto = activeForm === 'boleto';
            
            // Validar formul√°rio antes de salvar
            if (!validateForm(isBoleto)) {
                alert('Por favor, preencha todos os campos obrigat√≥rios corretamente antes de salvar.');
                return;
            }
            
            // Mostrar mensagem de carregamento
            const saveButton = document.getElementById('saveButton');
            const originalText = saveButton.innerHTML;
            saveButton.innerHTML = '‚è≥ Gerando PDF...';
            saveButton.disabled = true;
            
            try {
                // Criar PDF
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                // Configura√ß√µes da p√°gina
                const pageWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();
                const margin = 20;
                let yPosition = margin;
                
                // Adicionar cabe√ßalho com nome da empresa
                doc.setFontSize(20);
                doc.setFont('helvetica', 'bold');
                doc.text('SEM FRONTEIRAS - Ultrafibra', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                
                // Adicionar subt√≠tulo
                doc.setFontSize(14);
                doc.setFont('helvetica', 'normal');
                doc.text('Formul√°rio de Abertura de Chamado - Pessoa Jur√≠dica', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 8;
                
                // Adicionar tipo
                const tipo = isBoleto ? 'BOLETO' : 'D√âBITO EM CONTA';
                doc.text(`Tipo: ${tipo}`, pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 15;
                
                // Linha divis√≥ria
                doc.setDrawColor(76, 175, 80);
                doc.line(margin, yPosition, pageWidth - margin, yPosition);
                yPosition += 10;
                
                // Adicionar data
                doc.setFontSize(10);
                doc.setTextColor(100);
                const now = new Date();
                const dateStr = now.toLocaleDateString('pt-BR');
                const timeStr = now.toLocaleTimeString('pt-BR');
                doc.text(`Gerado em: ${dateStr} √†s ${timeStr}`, margin, yPosition);
                yPosition += 10;
                
                // Coletar dados do formul√°rio ativo
                const prefix = isBoleto ? '_boleto' : '';
                const activeFormId = isBoleto ? 'boleto' : 'debito';
                const fields = document.querySelectorAll(`#${activeFormId} input, #${activeFormId} select, #${activeFormId} textarea`);
                
                // Configurar fonte para conte√∫do
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(0);
                
                fields.forEach(field => {
                    if (field.type !== 'button' && field.type !== 'submit' && 
                        !field.classList.contains('gps-button') && 
                        !field.classList.contains('autofill-button') && 
                        field.value && field.value.trim() !== '') {
                        
                        // Verificar se precisa de nova p√°gina
                        if (yPosition > pageHeight - 20) {
                            doc.addPage();
                            yPosition = margin;
                        }
                        
                        const label = document.querySelector(`label[for="${field.id}"]`);
                        const labelText = label ? label.textContent.replace(' *', '').replace(':', '') : field.name;
                        
                        // Formatar o texto
                        const text = `${labelText}: ${field.value}`;
                        
                        // Quebrar texto longo
                        const lines = doc.splitTextToSize(text, pageWidth - (margin * 2));
                        
                        lines.forEach(line => {
                            if (yPosition > pageHeight - 20) {
                                doc.addPage();
                                yPosition = margin;
                            }
                            doc.text(line, margin, yPosition);
                            yPosition += 6;
                        });
                        
                        yPosition += 2; // Espa√ßo entre campos
                    }
                });
                
                // Adicionar rodap√© em todas as p√°ginas
                const totalPages = doc.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    doc.setPage(i);
                    doc.setFontSize(9);
                    doc.setTextColor(150);
                    doc.text(`P√°gina ${i} de ${totalPages}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Salvar o PDF
                const fileName = isBoleto ? 
                    'formulario_pj_internet_telefone_boleto.pdf' : 
                    'formulario_pj_internet_telefone_debito.pdf';
                
                doc.save(fileName);
                
                // Restaurar bot√£o
                saveButton.innerHTML = originalText;
                saveButton.disabled = false;
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                alert('Erro ao gerar PDF. Por favor, tente novamente.');
                
                // Restaurar bot√£o
                saveButton.innerHTML = originalText;
                saveButton.disabled = false;
            }
        });

        // FUN√á√ÉO PARA LIMPAR FORMUL√ÅRIO - ADICIONADA
        document.getElementById('clearButton').addEventListener('click', function() {
            const activeForm = document.querySelector('.form-section.active').id;
            const isBoleto = activeForm === 'boleto';
            
            if (confirm('Tem certeza que deseja limpar todos os campos do formul√°rio? Esta a√ß√£o n√£o pode ser desfeita.')) {
                // Selecionar todos os campos do formul√°rio ativo
                const fields = document.querySelectorAll(`#${activeForm} input, #${activeForm} select, #${activeForm} textarea`);
                
                fields.forEach(field => {
                    // Limpar apenas campos que n√£o s√£o bot√µes e n√£o s√£o readonly
                    if (field.type !== 'button' && 
                        !field.classList.contains('gps-button') && 
                        !field.classList.contains('autofill-button') &&
                        !field.readonly) {
                        
                        // Resetar para valor padr√£o baseado no tipo
                        if (field.type === 'text' || field.type === 'tel' || field.type === 'email') {
                            field.value = '';
                        } else if (field.type === 'select-one') {
                            field.selectedIndex = 0; // Selecionar primeira op√ß√£o (vazia)
                        } else if (field.type === 'textarea') {
                            field.value = '';
                        }
                        
                        // Remover classes de erro
                        field.classList.remove('validation-error');
                        
                        // Ocultar mensagens de erro
                        const errorElement = document.getElementById(field.id + '-error');
                        if (errorElement) {
                            errorElement.style.display = 'none';
                        }
                    }
                });
                
                // Limpar campos espec√≠ficos que s√£o readonly
                if (isBoleto) {
                    document.getElementById('coordenadas_boleto').value = '';
                    document.getElementById('localizacao_mapa_boleto').value = '';
                    document.getElementById('map_link_boleto').style.display = 'none';
                    document.getElementById('whatsapp_confirm_boleto').style.display = 'none';
                } else {
                    document.getElementById('coordenadas').value = '';
                    document.getElementById('localizacao_mapa').value = '';
                    document.getElementById('map_link').style.display = 'none';
                    document.getElementById('whatsapp_confirm').style.display = 'none';
                }
                
                // Atualizar op√ß√µes de cargo para o estado inicial
                updateCargoOptions();
                
                // Ocultar mensagem de sucesso se estiver vis√≠vel
                document.getElementById('successMessage').style.display = 'none';
                
                // Mostrar mensagem de confirma√ß√£o
                alert('Formul√°rio limpo com sucesso!');
            }
        });
    </script>
</body>
</html>